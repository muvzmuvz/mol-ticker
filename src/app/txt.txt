ğŸ“ ĞŸÑ€Ğ¾ĞµĞºÑ‚Ğ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°:

label-printer/
â”œâ”€â”€ backend/          # NestJS ÑĞµÑ€Ğ²ĞµÑ€
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â””â”€â”€ template.html     # HTML-ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½ ÑÑ‚Ğ¸ĞºĞµÑ‚ĞºĞ¸
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ print/
â”‚   â”‚   â”‚   â”œâ”€â”€ print.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ print.service.ts
â”‚   â”‚   â”œâ”€â”€ app.module.ts
â”‚   â”‚   â”œâ”€â”€ main.ts
â”‚   â”œâ”€â”€ package.json
â”œâ”€â”€ frontend/         # Angular Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ printer/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ printer.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ printer.html    
â”‚   â”‚   â”‚   â”œâ”€â”€ printer-card/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ printer-card.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ printer-card.html  
â”‚   â”‚   â”‚   â””â”€â”€ app.module.ts
â”‚   â”œâ”€â”€ package.json

==============================

ğŸ“¦ backend/src/print/print.service.ts:

```ts
import { Injectable } from '@nestjs/common';
import * as fs from 'fs';
import * as path from 'path';
import * as puppeteer from 'puppeteer';

@Injectable()
export class PrintService {
  async generatePdfBuffer(data: any, templateName: string, copies: number): Promise<Buffer> {
    const templatePath = path.join(__dirname, `../../assets/${templateName}.html`);
    let html = fs.readFileSync(templatePath, 'utf8');

    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ URL Ğ´Ğ»Ñ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ² (ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½Ğ¾Ğº)
    html = html.replace('<head>', `<head><base href="http://localhost:3000/">`);

    // ĞŸĞ¾Ğ´ÑÑ‚Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½
    html = html.replace(/{{name}}/g, data.name)
               .replace(/{{date}}/g, data.date)
               .replace(/{{weight}}/g, data.weight);

    const browser = await puppeteer.launch({ headless: true });
    const page = await browser.newPage();

    // Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¾ĞºĞ½Ğ° Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ PDF (Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ Ğ¿Ğ¾ ÑĞ²Ğ¾ĞµĞ¼Ñƒ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ñƒ)
    await page.setViewport({ width: 375, height: 189 });

    // Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ HTML Ñ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²
    await page.setContent(html, { waitUntil: 'networkidle0' });

    // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ PDF Ñ Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¼Ğ¸ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ°Ğ¼Ğ¸ Ğ¸ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ»ĞµĞ¹
    const pdfBuffer = await page.pdf({
      width: '98mm',
      height: '80mm',
      margin: { top: '0mm', bottom: '0mm', left: '0mm', right: '0mm' },
      printBackground: true,
    });

    await browser.close();
    return Buffer.from(pdfBuffer);
  }
}

```

ğŸ“¦ backend/src/print/print.controller.ts:

```ts
import { Controller, Post, Body, Res } from '@nestjs/common';
import { PrintService } from './print.service';
import { Response } from 'express';

@Controller('print')
export class PrintController {
  constructor(private readonly printService: PrintService) {}

  @Post()
  async print(@Body() body: { data: any; copies: number; templateName: string }, @Res() res: Response) {
    const pdfBuffer = await this.printService.generatePdfBuffer(body.data, body.templateName, body.copies);
    res.set({
      'Content-Type': 'application/pdf',
      'Content-Disposition': 'inline; filename=label.pdf',
    });
    res.send(pdfBuffer);
  }
}
```

ğŸ“¦ backend/src/app.module.ts:

```ts
import { Module } from '@nestjs/common';
import { ServeStaticModule } from '@nestjs/serve-static';
import { join } from 'path';

import { PrintController } from './print/print.controller';
import { PrintService } from './print/print.service';

@Module({
  imports: [
    ServeStaticModule.forRoot({
      rootPath: join(__dirname, '../assets'),  // Ğ¿ÑƒÑ‚ÑŒ Ğº Ğ¿Ğ°Ğ¿ĞºĞµ Ñ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºĞ°Ğ¼Ğ¸ Ğ¸ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ°Ğ¼Ğ¸
      serveRoot: '/assets',                       // URL, Ğ¿Ğ¾ ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ¼Ñƒ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ñ„Ğ°Ğ¹Ğ»Ñ‹
    }),
  ],
  controllers: [PrintController],
  providers: [PrintService],
})
export class AppModule { }

```

==============================

ğŸ“¦ frontend/src/app/printer/printer.ts:

import { Component } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { NgModule } from '@angular/core';
import { FormsModule } from '@angular/forms';

@Component({
  selector: 'app-printer',
  templateUrl: './printer.html',
  styleUrl: './printer.less',
  imports: [FormsModule]
})
export class PrinterComponent {
  product = {
    templateName: 'kolbasa', // ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ°
    name: '',
    date: '',
    weight: 0,
  };

  copies = 1; // ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ¿Ğ¸Ğ¹

  constructor(private http: HttpClient) { }

  print() {
    // Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµĞ¼ Ñ‚ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
    const requestBody = {
      templateName: this.product.templateName,
      copies: this.copies,
      data: {
        name: this.product.name,
        date: this.product.date,
        weight: this.product.weight.toFixed(3), // ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ 3 Ğ·Ğ½Ğ°ĞºĞ° Ğ¿Ğ¾ÑĞ»Ğµ Ğ·Ğ°Ğ¿ÑÑ‚Ğ¾Ğ¹
      }
    };

    // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ POST-Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€
    this.http.post('http://localhost:3000/print', requestBody, { responseType: 'blob' })
      .subscribe((pdfBlob) => {
        const blobUrl = URL.createObjectURL(pdfBlob);
        const printWindow = window.open(blobUrl);

        if (printWindow) {
          printWindow.addEventListener('load', () => {
            printWindow.print();
          });
        } else {
          alert('ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¾ĞºĞ½Ğ¾ Ğ´Ğ»Ñ Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ¸');
        }
      }, (error) => {
        console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ¸:', error);
        alert('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ½Ğ° Ğ¿ĞµÑ‡Ğ°Ñ‚ÑŒ');
      });
  }
}

```

ğŸ“¦ frontend/src/app/printer/printer.html:

```html
<div class="main">


<form class="label-form">
    <label for="name">ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°:</label>
    <input id="name" [(ngModel)]="product.name" name="name" placeholder="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°" />

    <label for="date">Ğ”Ğ°Ñ‚Ğ° Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ°:</label>
    <input id="date" type="date" [(ngModel)]="product.date" name="date" />

    <label for="weight">Ğ’ĞµÑ (Ğ² ĞºĞ³):</label>
    <input id="weight" type="number" [(ngModel)]="product.weight" name="weight" placeholder="0" min="0" step="0.01" />

    <button type="button" (click)="print()">ĞŸĞµÑ‡Ğ°Ñ‚ÑŒ</button>
</form>
</div>
```

ğŸ“¦ frontend/src/app/app.ts:

```ts
import { Component } from '@angular/core';
import { RouterOutlet } from '@angular/router';
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { FormsModule } from '@angular/forms';
import { HttpClientModule } from '@angular/common/http';
import { PrinterComponent } from './components/printer/printer';
import { CommonModule } from '@angular/common';
import { PrintCard } from './components/print-card/print-card';

@Component({
  selector: 'app-root',
  imports: [RouterOutlet, FormsModule, HttpClientModule, PrinterComponent, CommonModule, PrintCard],
  templateUrl: './app.html',
  styleUrl: './app.less'
})
export class App {
  protected title = 'mmol-ticket';
}

```
ğŸ“¦ frontend/src/app/app.html:
<router-outlet></router-outlet>
<div class="main">
  <app-print-card></app-print-card>
</div>

ğŸ“¦ frontend/src/app/printer-card/printer-card.html:
<div class="main">
    <div class="card-items">
        <img [src]="'img/' + product.templateName + '.jpg'" alt="ĞºĞ¾Ğ»Ğ±Ğ°ÑĞ°" class="product-img">
        <h3> {{ product.name }}</h3>
        <button (click)="openModal()" class="print-button">ĞŸĞµÑ‡Ğ°Ñ‚ÑŒ</button>
    </div>
</div>
<div class="modal" *ngIf="isOpen">
    <div class="modal-content">
        <span class="close" (click)="closeModal()">&times;</span>
        <app-printer class="modal-printer"></app-printer>
    </div>
</div>



ğŸ“¦ frontend/src/app/printer-card/printer-card.ts:
import { Component } from '@angular/core';
import { FormsModule } from '@angular/forms';
import { HttpClient } from '@angular/common/http';
import { NgModule } from '@angular/core';
import { PrinterComponent } from '../printer/printer';
import { CommonModule } from '@angular/common';

@Component({
  selector: 'app-print-card',
  imports: [FormsModule, PrinterComponent, CommonModule],
  templateUrl: './print-card.html',
  styleUrl: './print-card.less'
})
export class PrintCard {
  product = {
    templateName: 'docktorskaya', // ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ°
    name: 'Ğ”Ğ¾ĞºÑ‚Ğ¾Ñ€Ğ°ÑĞºĞ°Ñ ĞºĞ¾Ğ»Ğ±Ğ°ÑĞ°',
    date: '',
    weight: 0,
  };

  isOpen = false; // Ğ¤Ğ»Ğ°Ğ³ Ğ´Ğ»Ñ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾ĞºĞ½Ğ°
  openModal() {
    this.isOpen = true;
  }

  closeModal() {
    this.isOpen = false;
  }
}


==============================

ğŸ“¦ backend/assets/template.html:

(ÑĞ¼. Ñ€Ğ°Ğ½ĞµĞµ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ HTML Ñ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ `{{name}}`, `{{date}}`, `{{weight}}`).
